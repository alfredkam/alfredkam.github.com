<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Thoughts of Coding & Entrepreneurship</title>

        <link rel='stylesheet' href='/assets/components/bootstrap/dist/css/bootstrap.min.css' />
        <link rel='stylesheet' href='/assets/css/base.css' />
        <link rel='stylesheet' href='/assets/components/prismjs/prism-okaidia.css' />

        <!-- fontello -->
        <link rel="stylesheet" href="/assets/css/fontello-f0d4ae31/css/message.css" />
        <link rel="stylesheet" href="/assets/css/fontello-f0d4ae31/css/animation.css" />
        <!--[if IE 7]>
        <link rel="stylesheet" href="/assets/css/fontello-f0d4ae31/css/message-ie7.css" />
        <![endif]-->

        <!-- open sans font -->
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css' />
    </head>
    <body>
    <header>
    <!-- nav -->
<nav class="navbar navbar-default" role="navigation">
    <div class='row'>
        <div class='col-sm-1 center'>
           <a class="navbar-brand" href="/">AK</a>
        </div>
        <div class='col-sm-10'>
            <div class="navbar-header col-sm-12 title">
                <div class='col-sm-12'>
                    <span><a href='/'>Thoughts of Coding & Entrepreneurship</a></span>
                </div>
            </div>
        </div>
    </div>
</nav>
    </header>
    <div>
        <!-- This loops through the paginated posts -->


<div class='row'>
  <div class='col-md-1 center'>
      <div class='commentCount'>
        <a href='/using-git-hooks-to-deploy-server-with-forever'>
          <span>
            <l class='icon-chat-1'></l>
          </span>
          <span>
            <a href="/using-git-hooks-to-deploy-server-with-forever#disqus_thread">
                0
            </a>
          </span>
        </a>
      </div>
  </div>
  <section class='post col-md-10'>
    <h1><a href="/using-git-hooks-to-deploy-server-with-forever">using git hooks to deploy server with forever</a></h1>
    <p class="author">
      <span class="date">2014-02-17 00:00:00 -0500</span>
    </p>
    <div class="content">
      <p>If you love deploying with automation and you love the fact you dont need to touch your server (which you should!).  I've setup this up on an ec2 ubuntu 12.04 LTS, shouldnt differ too much with other ubuntu versions.  At this time of writing i'm setting up a nodejs / flask server</p>
<p>On your remote server</p>
<pre><code class='language-markup'>
#install forever and give it global access
sudo npm install -g forever
</code></pre>
<pre><code class='language-markup'>
#setup git bare at your deployment server
git clone --bare [repo url]
</code></pre>
<pre><code class='language-markup'>
#add the hooks
#navigate into your git folder
cd path/to/repo/hooks
vi pre-receive
</code></pre>
<pre><code class='language-bash'>
#!/bin/sh
echo "stopping server service"
service nodejs-www stop
</code></pre>
<pre><code class='language-bash'>
vi post-receive
</code></pre>
<pre><code class='language-bash'>
#!/bin/sh
echo "checkout the files"

branch=$(git branch | grep "*" | sed "s/* //")

if [ "$branch" = "master" ]
then
        echo "Master branch"
        git --work-tree=/home/ubuntu/app/www checkout -f
        echo "Successfully checked out master branch"
else
        echo "Not master branch"
fi

echo "start service"
service nodejs-www start
</code></pre>
<pre><code class='language-markup'>
sudo chmod +x pre-receive;
sudo chmod +x post-receive;
</code></pre>
<p>FYI: Just make sure the folders are created for the "git --work-tree"</p>
<pre><code class='language-markup'>
#navigate into init.d to create a service
cd /etc/init.d
sudo vi nodejs-www
</code></pre>
<pre><code class='language-bash'>
#! /bin/sh
# /etc/init.d/nodejs-www
#

NAME=nodejs-www
APP=index.js
APP_DIR=/home/ubuntu/app/www
forever=/usr/local/bin/forever
export PATH=$PATH:/usr/local/bin/
LOG=/var/log/nodejs-www.log

case "$1" in
  start)
    cd $APP_DIR
    echo "Starting $NAME"
    #I detached the message to 'screen', it is not a requirement
    screen -d -m /usr/bin/sudo -u ubuntu $forever --minUptime 5000 --spinSleepTime 2000 -a -l $LOG start $APP
    #if to run a python server use
    #screen -d -m /usr/bin/sudo -u ubuntu $forever --minUptime 5000 --spinSleepTime 2000 -a -l $LOG start -c python $APP
    echo "Started $Name"
    exit 0
    ;;
  stop)
    echo "Stopping script $NAME"
    cd $APP_DIR
    /usr/bin/sudo -u ubuntu $forever stop $APP
    exit 0
    ;;
  list)
    echo "List"
    /usr/bin/sudo -u ubuntu $forever list
    exit 0
    ;;
  *)
    echo "Usage: /etc/init.d/nodejs-www {start|stop|list}"
    exit 1
    ;;
esac

exit 0
</code></pre>
<p>FYI: Many others were able to run forever directly without having "/usr/bin/sudo -u ubuntu" (ubuntu is the user account) or substituting it with "sudo".  For my case on an amazon aws, without it, i ran into permission issues with forever and nodejs directory mapping issues.</p>
<p>A permission error similar to this:</p>
<pre><code class='language-javascript'>
fs.js:0
(function (exports, require, module, __filename, __dirname) { // Copyright Joy
^
Error: EACCES, permission denied '/root/.forever/pids/FepR.pid'
    at Object.fs.openSync (fs.js:410:18)
    at Object.fs.writeFileSync (fs.js:956:15)
    at writePid (/usr/local/lib/node_modules/forever/bin/monitor:13:6)
    at null.<anonymous> (/usr/local/lib/node_modules/forever/bin/monitor:46:5)
    at EventEmitter.emit (/usr/local/lib/node_modules/forever/node_modules/forever-monitor/node_modules/broadway/node_modules/eventemitter2/lib/eventemitter2.js:332:22)
    at /usr/local/lib/node_modules/forever/node_modules/forever-monitor/lib/forever-monitor/monitor.js:153:10
</code></pre>
<p>Now to wrap up the server side</p>
<pre><code class='language-markup'>
sudo chmod a+x nodejs-www
cd /var/log
sudo touch nodejs-www.log
sudo chmod 777 nodejs-www.log
</code></pre>
<p>Add to rc.local to start upon server start</p>
<pre><code class='language-markup'>
sudo vi /etc/rc.local
</code></pre>
<pre><code class='language-markup'>
#!/bin/sh -e
service nodejs-www start
exit 0
</code></pre>
<p>For some you may need to change the rc.local permission to executable.</p>
<p>If i didnt miss anything this should it for the server</p>
<p>Now on client side</p>
<pre><code class='language-markup'>
cd path/to/repo
git remote add deploy [remote server repo url]
git commit -am 'test deploy'
git push deploy master
</code></pre>
<p>This should be it, and the service should automatically stop and restart itself.  If i missed anything let me know :)</p>

    </div>
  </section>
</div>

<div class='row'>
  <div class='col-md-1 center'>
      <div class='commentCount'>
        <a href='/node-nodejs-stack-setup'>
          <span>
            <l class='icon-chat-1'></l>
          </span>
          <span>
            <a href="/node-nodejs-stack-setup#disqus_thread">
                0
            </a>
          </span>
        </a>
      </div>
  </div>
  <section class='post col-md-10'>
    <h1><a href="/node-nodejs-stack-setup">nginx / nodejs stack setup</a></h1>
    <p class="author">
      <span class="date">2014-02-17 00:00:00 -0500</span>
    </p>
    <div class="content">
      <p>So when you have an nginx + nodejs combo, you want to use <i>nginx to port foward to nodejs</i></p>
<p>my nodejs uses forever to run on port 3000.</p>
<p>here is the nginx config setup</p>
<pre>
<code class="language-bash">
sudo vi /etc/nginx/site-enabled/default
</code>
</pre>
<pre>
<code class="language-bash">
#add this line before server { ... }
[...]
upstream app_nodejs {
        server localhost:3000;
}
[...]

#now in server {...}, assuming you want to map your url root to point to nodejs
location / {
               proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
               proxy_set_header Host $http_host;
               proxy_set_header X-NginX-Proxy true;

               proxy_pass http://app_nodejs;
               proxy_redirect off;
           }

</code>
</pre>
<p>Cheers</p>

    </div>
  </section>
</div>

<div class='row'>
  <div class='col-md-1 center'>
      <div class='commentCount'>
        <a href='/nginx-with-phpmyadmin-setup'>
          <span>
            <l class='icon-chat-1'></l>
          </span>
          <span>
            <a href="/nginx-with-phpmyadmin-setup#disqus_thread">
                0
            </a>
          </span>
        </a>
      </div>
  </div>
  <section class='post col-md-10'>
    <h1><a href="/nginx-with-phpmyadmin-setup">nginx with changed phpmyadmin directory setup</a></h1>
    <p class="author">
      <span class="date">2014-02-17 00:00:00 -0500</span>
    </p>
    <div class="content">
      <p>Recently decided to setup a nginx / python / mysql lightweight backend to interact with a nodejs services.   So decided to change phpmyadmin directory as well - i did run into 502 / 403 nginx errors, hope this post will help anyone who had the same issues too.</p>
<p>Setup process - assuming you are using ubuntu 12.04LTS</p>
<pre>
<code class="language-markup">
#install mysql & nginx
sudo apt-get install mysql-server mysql-client
sudo apt-get install nginx

#start nginx
sudo service nginx start

#install php5 & phpmyadmin
sudo apt-get install php5-fpm php5-mysql php5-curl php5-gd php5-intl php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-ming php5-ps php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl php5-xcache phpmyadmin

#reload php5
sudo service php5-fpm reload
</code>
</pre>
<pre>
<code class="language-markup">
#modify php5-fpm
sudo vi /etc/php5/fpm/pool.d/www.conf
</code>
</pre>
<pre><code class="language-bash">
#look for listen and modify as follow
[...]
;listen = 127.0.0.1:9000
listen = /tmp/php5-fpm.sock
[...]
</code>
</pre>
<pre>
<code class="language-markup">
#setup nginx config
sudo vi /etc/nginx/site-enabled/default
</code>
</pre>
<pre>
<code class="language-bash">
#add this after location /
[...]
location /pma {
    alias /usr/share/phpmyadmin/;
}

location ~ ^/pma/(.*\.(js|css|gif|jpg|png))$ {
    alias /usr/share/phpmyadmin/$1;
}

location ~ ^/pma(.+\.php)$ {
    alias /usr/share/phpmyadmin$1;
    fastcgi_pass unix:/tpm/php5-fpm.sock;
    fastcgi_index index.php;

    charset utf8;

    include fastcgi_params;
    fastcgi_param DOCUMENT_ROOT /usr/share/phpmyadmin;
}

#if you want to enable php site wide
location ~ \.php$ {
                try_files $uri =404;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_pass unix:/tmp/php5-fpm.sock;
                fastcgi_index index.php;
                include fastcgi_params;
}
[...]
</code>
</pre>
<pre>
<code class="language-markup">
sudo service nginx reload
</code>
</pre>
<p>FYI: The most common 502 / 403 errors are due to this line in the nginx config file. </p>
<pre>
<code class="language-bash">
fastcgi_pass unix:/tmp/php5-fpm.sock; #example using unix:/var/run/php-fpm.sock; 
</code>
</pre>
<p>Hopefully this post will help some travellers here.</p>
<p><b>Source</b><br>
<a href="http://stackoverflow.com/questions/17359413/nginx-change-phpmyadmin-directory">stackoverflow</a><br />
<a href="http://www.howtoforge.com/installing-nginx-with-php5-and-php-fpm-and-mysql-support-lemp-on-ubuntu-12.04-lts">howtoforge</a></p>

    </div>
  </section>
</div>

<div class='row'>
  <div class='col-md-1 center'>
      <div class='commentCount'>
        <a href='/typical-way-of-starting-a-startup'>
          <span>
            <l class='icon-chat-1'></l>
          </span>
          <span>
            <a href="/typical-way-of-starting-a-startup#disqus_thread">
                0
            </a>
          </span>
        </a>
      </div>
  </div>
  <section class='post col-md-10'>
    <h1><a href="/typical-way-of-starting-a-startup">Typical way of starting a startup</a></h1>
    <p class="author">
      <span class="date">2013-05-24 00:00:00 -0400</span>
    </p>
    <div class="content">
      <p>Found this gold on the net.  Felt should keep a record here :)</p>
<p><a href="/assets/img/2013/05/startup-cycle.png"><img src="/assets/img/2013/05/startup-cycle.png" alt="startup-cycle" width="600" height="482" class="alignnone size-medium wp-image-251" /></a></p>

    </div>
  </section>
</div>

<div class='row'>
  <div class='col-md-1 center'>
      <div class='commentCount'>
        <a href='/online-presence'>
          <span>
            <l class='icon-chat-1'></l>
          </span>
          <span>
            <a href="/online-presence#disqus_thread">
                0
            </a>
          </span>
        </a>
      </div>
  </div>
  <section class='post col-md-10'>
    <h1><a href="/online-presence">Online Presence</a></h1>
    <p class="author">
      <span class="date">2013-05-16 00:00:00 -0400</span>
    </p>
    <div class="content">
      <p>Previously my co-founder <a href="http://twitter.com/andrewcboos">Andrew Boos</a> followed up on the topic of <a href='http://andrewboos.com/the-difference-between-vcs-and-angels-reboot/'>difference of VCs and Angels</a>. Continuo on the topic of start ups, this time lets cover online presence.</p>
<p>Your startup's online presence is relatively important to represent who you are, your cool product and how your customers can benefit from using it. In our startup <a href="http://appfuel.me">Appfuel</a>, it took us a good 2 months to get it straight. Resulting an increase of web traffic.</p>
<p>Spilling the beans:<br />
1. Active social presence in<br />
- Facebook page<br />
- Twitter Profile<br />
- AngelList</p>
<p>Your social presence represents what your startup is made out off. Using these social platforms to pump out messages, cool stories and keep you consumer of interest up to date.</p>
<p>There are great tools such as <a href="http://bufferapp.com">Buffer</a>, <a href="http://ifttt.com">if this then that</a> to help you manage.</p>
<p>2. Landing Page<br />
When someone first enters into your site, with average browser size of 1280px  * 720px on desktops and 320px *  480px on mobile. That is some relatively small space, but hey! That will determine if the user will continue reading on. You should spice up the landing page's image, and it will determine if the reader will continue reading on.</p>
<p>3. SEO ( Search Engine Optimization)<br />
Another method to deliver organic traffic to your site are through searches. Make sure you have included meta tags of "description" and "keywords"; A short info in how you can help them; Submit your sitemap into the search engines.</p>
<p>4. Blog<br />
Posting relavent information, tips, stories for the consumer drives relavent traffic and ultimately landing in as your customer.</p>
<p>There are tools such as <a href="http://hittail.com">hittail</a> and google analytics to help you drill down to specific keywords that are driving traffic to your site.</p>
<p>As for ours we spiced up our blog a little bit just so the travellers can read the relavent posts, picture below.</p>
<p><a href="/assets/img/2013/05/Screen-Shot-2013-05-15-at-8.23.07-PM.png"><img class="alignnone size-medium wp-image-233" alt="IAMA - mortal - dev - show all" src="/assets/img/2013/05/Screen-Shot-2013-05-15-at-8.23.07-PM.png" width="600" height="114" /></a></p>

    </div>
  </section>
</div>

<div class='row'>
  <div class='col-md-1'>

  </div>
  <div class='col-md-11'>
  <!-- Pagination links -->
  
  <div class="pagination">
    
      <a href="/index.html">&laquo; Prev</a>
    

    
      
        <a href="/index.html">1</a>
      
    
      
        <em>2</em>
      
    
      
        <a href="/page/3">3</a>
      
    
      
        <a href="/page/4">4</a>
      
    
      
        <a href="/page/5">5</a>
      
    

    
      <a href="/page/3">Next &raquo;</a>
    
  </div>
  
  </div>
</div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'alfredkam'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
    </div>
</body>
    <footer class='row'>
        <div class='col-md-10 col-md-offset-1'>
            <div class='row'>
              <div class='col-md-4'>
                <h4>
                  About
                </h4>
                <p>
                  Hello! I'm an Entrepreneur & Developer with primiary focus in javascript.  I'm also active in the field of computational biology.
                </p>
              </div>
              <div class='col-md-4'>
                <h4>
                  Notable Works
                </h4>
                <p>
                  <a href='http://appfuel.me'>Appfuel</a><br>
                  <a href='http://phylo.cs.mcgill.ca'>PHYLO</a>
                </p>
              </div>
              <div class='col-md-4'>
                <h4>
                  Stalking Aids
                </h4>
                <p>
                  GitHub <a href='http://github.com/alfredkam'>@AlfredKam</a><br>
                  Twitter <a href='https://twitter.com/alfredkam'>@AlfredKam</a><br>
                  LinkedIn <a href='http://www.linkedin.com/in/kamalfred'>@KamAlfred</a>
                </p>
              </div>
            </div>
            <div class='row'>
              <div class='col-md-12'>
                Alfred Kam &#169; 2014
              </div>
            </div>
        </div>    
    </footer>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('require', 'displayfeatures');
      ga('create', 'UA-25416273-1', 'alfredkam.com');
      ga('send', 'pageview');
    </script>
    <script src='/assets/components/jquery/jquery.min.js' type='text/javascript'></script>
    <script src='/assets/components/lodash/dist/lodash.min.js' type='text/javascript'></script>
    <script src='/assets/components/moment/min/moment.min.js' type='text/javascript'></script>
    <script type='text/javascript'>
      $('code').each(function () {
        var html = _.escape($(this).html());
        html = html.replace(/&amp;lt;/g,'&lt;');
        html = html.replace(/&amp;gt;/g,'&gt;');
        $(this).html(html);
      });

      $('.date').each(function () {
        var html = $(this).html();
        $(this).html(moment(html).format('ll'));
      });
    </script>
    <script src='/assets/components/bootstrap/dist/js/bootstrap.min.js' type='text/javascript'></script>
    <script src='/assets/scripts/base.js' type='text/javascript'></script>
    <script src='/assets/components/prismjs/prism.js' type='text/javascript'/></script>
    <script src='/assets/components/prismjs/components/prism-markup.min.js' type="text/javascript"></script>
    <script src='/assets/components/prismjs/components/prism-bash.min.js' type='text/javascript'></script>
    <script src='/assets/components/prismjs/components/prism-css.min.js' type='text/javascript'></script>
    <script src='/assets/components/prismjs/components/prism-javascript.min.js' type='text/javascript'></script>
    <script src='/assets/components/prismjs/components/prism-python.min.js' type="text/javascript"></script>
</html>
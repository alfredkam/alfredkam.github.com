<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>nginx with changed phpmyadmin directory setup</title>

        <link rel='stylesheet' href='assets/css/base.css' />
        <link rel='stylesheet' href='assets/components/bootstrap/dist/css/bootstrap.min.css' />

        <!-- open sans font -->
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css' />
    </head>
    <body>
    <header>
    <nav class="nav-primary" role="navigation" >
    <ul>
        <li><a  href='/'>Home</a></li>
        <li><a  href='/about'>About</a></li>
    </ul>
</nav>
    </header>
    <h1>nginx with changed phpmyadmin directory setup</h1>
    <p>Recently decided to setup a nginx / python / mysql lightweight backend to interact with a nodejs services.   So decided to change phpmyadmin directory as well - i did run into 502 / 403 nginx errors, hope this post will help anyone who had the same issues too.</p>
<p>Setup process - assuming you are using ubuntu 12.04LTS</p>
<pre>
<code class="language-markup">
#install mysql & nginx
sudo apt-get install mysql-server mysql-client
sudo apt-get install nginx

#start nginx
sudo service nginx start

#install php5 & phpmyadmin
sudo apt-get install php5-fpm php5-mysql php5-curl php5-gd php5-intl php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-ming php5-ps php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl php5-xcache phpmyadmin

#reload php5
sudo service php5-fpm reload
</code>
</pre>
<pre>
<code class="language-markup">
#modify php5-fpm
sudo vi /etc/php5/fpm/pool.d/www.conf
</code>
</pre>
<pre><code class="language-bash">
#look for listen and modify as follow
[...]
;listen = 127.0.0.1:9000
listen = /tmp/php5-fpm.sock
[...]
</code>
</pre>
<pre>
<code class="language-markup">
#setup nginx config
sudo vi /etc/nginx/site-enabled/default
</code>
</pre>
<pre>
<code class="language-bash">
#add this after location /
[...]
location /pma {
    alias /usr/share/phpmyadmin/;
}

location ~ ^/pma/(.*\.(js|css|gif|jpg|png))$ {
    alias /usr/share/phpmyadmin/$1;
}

location ~ ^/pma(.+\.php)$ {
    alias /usr/share/phpmyadmin$1;
    fastcgi_pass unix:/tpm/php5-fpm.sock;
    fastcgi_index index.php;

    charset utf8;

    include fastcgi_params;
    fastcgi_param DOCUMENT_ROOT /usr/share/phpmyadmin;
}

#if you want to enable php site wide
location ~ \.php$ {
                try_files $uri =404;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_pass unix:/tmp/php5-fpm.sock;
                fastcgi_index index.php;
                include fastcgi_params;
}
[...]
</code>
</pre>
<pre>
<code class="language-markup">
sudo service nginx reload
</code>
</pre>
<p>FYI: The most common 502 / 403 errors are due to this line in the nginx config file. </p>
<pre>
<code class="language-bash">
fastcgi_pass unix:/tmp/php5-fpm.sock; #example using unix:/var/run/php-fpm.sock; 
</code>
</pre>
<p>Hopefully this post will help some travellers here.</p>
<p><label><b>Source<b><br />
<a href="http://stackoverflow.com/questions/17359413/nginx-change-phpmyadmin-directory">stackoverflow</a><br />
<a href="http://www.howtoforge.com/installing-nginx-with-php5-and-php-fpm-and-mysql-support-lemp-on-ubuntu-12.04-lts">howtoforge</a></p>

</body>
    <footer>
        
    </footer>
</html>